@{
    ViewData["Title"] = "Agente Bot";
}

<h2 class="mb-4 fw-bold text-center">🤖 Agente Bot</h2>

<div class="card p-3 shadow-sm" style="max-width: 600px; margin: 0 auto;">
    <div id="chatBox" class="border rounded p-3 mb-3" style="height: 300px; overflow-y: auto; background-color: #f8f9fa;">
        <div class="text-muted text-center">Escribe tu pregunta abajo 👇</div>
    </div>

    <form id="botForm" class="d-flex">
        <input type="text" id="userMessage" class="form-control me-2" placeholder="Escribe tu pregunta...">
        <button type="submit" class="btn btn-primary">Enviar</button>
    </form>
</div>

@section Scripts {
    <script>
        const form = document.getElementById("botForm");
        const input = document.getElementById("userMessage");
        const chatBox = document.getElementById("chatBox");

        form.addEventListener("submit", function (e) {
            e.preventDefault();

            const message = input.value.trim();
            if (message === "") return;

            chatBox.innerHTML += `<div><strong>Tú:</strong> ${message}</div>`;

            fetch("/Bot/GetResponse", {
                method: "POST",
                headers: { "Content-Type": "application/x-www-form-urlencoded" },
                body: `userMessage=${encodeURIComponent(message)}`
            })
            .then(response => response.json())
            .then(data => {
                chatBox.innerHTML += `<div><strong>Bot:</strong> ${data.reply}</div>`;
                chatBox.scrollTop = chatBox.scrollHeight;
            });

            input.value = "";
        });
    </script>
}
